---
const { size = null } = Astro.props;
const timeline = [
    {
        date: "Feb 2024 - Present",
        title: "Technical Lead",
        company: "PT Completed Inovasi Teknologi",
        description: "Leading Backend and Frontend team.",
        skills: ["Go", "Node.js", "MySQL", "Redis", "Docker"],
    },
    {
        date: "Mar 2023 - Jan 2024",
        title: "Senior Backend Engineer",
        company: "PT Majoo Teknologi Indonesia",
        description: "Developing REST API using Go and PHP.",
        skills: ["Go", "PHP", "MySQL", "MongoDB", "Redis", "Docker"],
    },
    {
        date: "Dec 2022 - Feb 2023",
        title: "Backend Engineer",
        company: "PT Majoo Teknologi Indonesia",
        description: "Developing micro service for affiliate using Go.",
        skills: ["Go", "PHP", "MySQL", "Redis", "Docker"],
    },
    {
        date: "Mar 2022 - Nov 2022",
        title: "Full Stack Engineer",
        company: "PT Majoo Teknologi Indonesia",
        description: "Developing CRM (Customer Relationships Management).",
        skills: ["PHP", "MySQL", "Javascript", "Redis", "Docker"],
    },
    {
        date: "Oct 2018 - Feb 2022",
        title: "Full Stack Engineer",
        company: "PT Bilik Digital Indonesia",
        description: "Developing CRM (Customer Relationships Management).",
        skills: ["PHP", "Node.js", "MySQL", "Javascript", "Redis"],
    },
    {
        date: "Aug 2017 - Feb 2022",
        title: "Freelance Web Developer",
        company: "Self-employed",
        description: "Developing web applications for various clients.",
        skills: ["PHP", "MySQL", "JavaScript", "HTML", "CSS"],
    },
];

const limit = size === null ? timeline.length : size;

import CallToAction from "./CallToAction.astro";
---

<div class="timeline">
    {
        timeline.slice(0, limit).map((item) => (
            <div class="timeline-item">
                <div class="timeline-content">
                    <div>
                        <h3>{item.title}</h3>
                        <h4>{item.company}</h4>
                        <p>{item.date}</p>
                    </div>
                    <div class="mt-20">
                        <p>{item.description}</p>
                    </div>
                    <div class="mt-20">
                        <strong>Skills: </strong>
                        {item.skills.map((skill, index) => (
                            <span>
                                {index < item.skills.length - 1
                                    ? `${skill}, `
                                    : skill}
                            </span>
                        ))}
                    </div>
                </div>
            </div>
        ))
    }
    {
        limit < timeline.length && (
            <div class="see-more">
                <CallToAction href="/experiences">See more</CallToAction>
            </div>
        )
    }
</div>

<style>
    .timeline {
        position: relative;
        margin: 0 auto;
        padding: 3rem 2rem;
        width: 100%;
    }

    .timeline::before {
        content: "";
        position: absolute;
        width: 4px;
        background: linear-gradient(
            to bottom,
            var(--accent-regular),
            var(--accent-dark)
        );
        top: 0;
        bottom: 0;
        left: 20px;
        border-radius: 2px;
        box-shadow: 0 0 20px rgba(var(--accent-regular-rgb), 0.4);
    }

    .timeline-item {
        padding: 15px 0 15px 50px;
        position: relative;
        width: 100%;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .timeline-item:hover {
        transform: scale(1.03) translateY(-3px);
    }

    .timeline-item::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        left: 12px;
        top: 25px;
        background: var(--accent-regular);
        border-radius: 50%;
        transition: all 0.4s ease;
        box-shadow: 0 0 15px rgba(var(--accent-regular-rgb), 0.5);
        border: 3px solid var(--gray-999);
    }

    .timeline-item:hover::after {
        background: var(--accent-dark);
        box-shadow: 0 0 25px rgba(var(--accent-regular-rgb), 0.7);
        transform: scale(1.2);
    }

    .timeline-content {
        padding: 30px;
        background: var(--gray-999);
        border-radius: 20px;
        box-shadow: var(--shadow-md);
        border: 2px solid var(--gray-800);
        transition: all 0.4s ease;
        backdrop-filter: blur(10px);
    }

    .timeline-content:hover {
        box-shadow:
            var(--shadow-lg),
            0 0 20px rgba(var(--accent-regular-rgb), 0.2);
        border-color: var(--accent-regular);
        transform: translateY(-2px);
    }

    .timeline-content h3 {
        margin: 0;
        color: var(--gray-0);
        font-size: clamp(var(--text-lg), 2vw, var(--text-xl));
        font-weight: 700;
        letter-spacing: 0.5px;
    }

    .timeline-content h4 {
        margin: 0.5rem 0;
        color: var(--accent-regular);
        font-size: clamp(var(--text-sm), 1.5vw, var(--text-md));
        font-weight: 600;
        letter-spacing: 0.3px;
    }

    .timeline-content p {
        margin: 0.5rem 0 0;
        color: var(--gray-200);
        line-height: 1.8;
    }

    .see-more {
        text-align: center;
        margin: 4rem auto 0;
        max-width: 30rem;
    }

    .mt-20 {
        margin-top: 1rem;
    }

    @media (min-width: 50em) {
        .timeline::before {
            left: 50%;
            margin-left: -2px;
        }

        .timeline-item {
            width: 50%;
            padding: 15px 40px;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
        }

        .timeline-item:nth-child(odd)::after {
            right: -9px;
            left: auto;
        }

        .timeline-item:nth-child(even) {
            left: 50%;
        }

        .timeline-item:nth-child(even)::after {
            left: -9px;
        }

        .timeline-content h3 {
            font-size: var(--text-xl);
        }

        .timeline-content h4 {
            font-size: var(--text-md);
        }
    }
</style>
